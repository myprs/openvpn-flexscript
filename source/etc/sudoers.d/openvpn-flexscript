# Sudoers file for opvnflex.
# Edit users to suit your distribution and
# obenvpn configuration.

User_Alias	OVPNFLEXSTAGE0USER = nobody
User_Alias	OVPNFLEXSTAGE1USER = openvpn

# inherit openvpn environment!
# All staticly named variables are added to env-keep. If you need to work on 
# non statically named variables (see the commented lines in list), you need to
# keep all variables (uncomment the first line in list). 
# This might impose risks and handle with care.

## Defaults!OVPNFLEXSCRIPT	!env_reset

Defaults!OVPNFLEXSCRIPT env_keep += "bytes_received"
Defaults!OVPNFLEXSCRIPT env_keep += "bytes_sent"
Defaults!OVPNFLEXSCRIPT env_keep += "common_name"
Defaults!OVPNFLEXSCRIPT env_keep += "config"
Defaults!OVPNFLEXSCRIPT env_keep += "daemon"
Defaults!OVPNFLEXSCRIPT env_keep += "daemon_log_redirect"
Defaults!OVPNFLEXSCRIPT env_keep += "dev"
Defaults!OVPNFLEXSCRIPT env_keep += "dev_idx"
#Defaults!OVPNFLEXSCRIPT env_keep += "foreign_option_{n}"
Defaults!OVPNFLEXSCRIPT env_keep += "ifconfig_broadcast"
Defaults!OVPNFLEXSCRIPT env_keep += "ifconfig_ipv6_local"
Defaults!OVPNFLEXSCRIPT env_keep += "ifconfig_ipv6_netbits"
Defaults!OVPNFLEXSCRIPT env_keep += "ifconfig_ipv6_remote"
Defaults!OVPNFLEXSCRIPT env_keep += "ifconfig_local"
Defaults!OVPNFLEXSCRIPT env_keep += "ifconfig_remote"
Defaults!OVPNFLEXSCRIPT env_keep += "ifconfig_netmask"
Defaults!OVPNFLEXSCRIPT env_keep += "ifconfig_pool_local_ip"
Defaults!OVPNFLEXSCRIPT env_keep += "ifconfig_pool_netmask"
Defaults!OVPNFLEXSCRIPT env_keep += "ifconfig_pool_remote_ip"
Defaults!OVPNFLEXSCRIPT env_keep += "link_mtu"
Defaults!OVPNFLEXSCRIPT env_keep += "local"
Defaults!OVPNFLEXSCRIPT env_keep += "local_port"
Defaults!OVPNFLEXSCRIPT env_keep += "password"
Defaults!OVPNFLEXSCRIPT env_keep += "proto"
#Defaults!OVPNFLEXSCRIPT env_keep += "remote_{n}"
#Defaults!OVPNFLEXSCRIPT env_keep += "remote_port_{n}"
Defaults!OVPNFLEXSCRIPT env_keep += "route_net_gateway"
Defaults!OVPNFLEXSCRIPT env_keep += "route_vpn_gateway"
#Defaults!OVPNFLEXSCRIPT env_keep += "route_{parm}_{n}"
#Defaults!OVPNFLEXSCRIPT env_keep += "route_ipv6_{parm}_{n}"
Defaults!OVPNFLEXSCRIPT env_keep += "peer_cert"
Defaults!OVPNFLEXSCRIPT env_keep += "script_context"
Defaults!OVPNFLEXSCRIPT env_keep += "script_type"
Defaults!OVPNFLEXSCRIPT env_keep += "signal"
Defaults!OVPNFLEXSCRIPT env_keep += "time_ascii"
Defaults!OVPNFLEXSCRIPT env_keep += "time_duration"
Defaults!OVPNFLEXSCRIPT env_keep += "time_unix"
#Defaults!OVPNFLEXSCRIPT env_keep += "tls_digest_{n}"
#Defaults!OVPNFLEXSCRIPT env_keep += "tls_id_{n}"
#Defaults!OVPNFLEXSCRIPT env_keep += "tls_serial_{n}"
#Defaults!OVPNFLEXSCRIPT env_keep += "tls_serial_hex_{n}"
Defaults!OVPNFLEXSCRIPT env_keep += "tun_mtu"
Defaults!OVPNFLEXSCRIPT env_keep += "trusted_ip"
Defaults!OVPNFLEXSCRIPT env_keep += "trusted_ip6"
Defaults!OVPNFLEXSCRIPT env_keep += "trusted_port"
Defaults!OVPNFLEXSCRIPT env_keep += "untrusted_ip"
Defaults!OVPNFLEXSCRIPT env_keep += "untrusted_ip6"
Defaults!OVPNFLEXSCRIPT env_keep += "untrusted_port"
Defaults!OVPNFLEXSCRIPT env_keep += "username"
Defaults!OVPNFLEXSCRIPT env_keep += "X509_0_emailAddress"
Defaults!OVPNFLEXSCRIPT env_keep += "X509_0_CN"
Defaults!OVPNFLEXSCRIPT env_keep += "X509_0_O"
Defaults!OVPNFLEXSCRIPT env_keep += "X509_0_ST"
Defaults!OVPNFLEXSCRIPT env_keep += "X509_0_C"
Defaults!OVPNFLEXSCRIPT env_keep += "X509_1_emailAddress"
Defaults!OVPNFLEXSCRIPT env_keep += "X509_1_O"
Defaults!OVPNFLEXSCRIPT env_keep += "X509_1_L"
Defaults!OVPNFLEXSCRIPT env_keep += "X509_1_ST"
Defaults!OVPNFLEXSCRIPT env_keep += "X509_1_C"



Cmnd_Alias	OVPNFLEXSCRIPT = /usr/local/sbin/ovpnflexscript


Runas_Alias	OVPNFLEXSTAGE1USER = openvpn

# OVPNFLEXSTAGE0USER is allowed to run the script as OVPNFLEXSTAGE1USER
OVPNFLEXSTAGE0USER	ALL = (OVPNFLEXSTAGE1USER) NOPASSWD: SETENV: OVPNFLEXSCRIPT

# OVPNFLEXSTAGE1USER is allowed to run the script as root
OVPNFLEXSTAGE1USER	ALL = (root) NOPASSWD: SETENV: OVPNFLEXSCRIPT


